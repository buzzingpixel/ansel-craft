function runFabController(e){"use strict";if(void 0!==window.jQuery){var o=window.jQuery,n={},t=[],r=function(t,r){var i;return"object"==typeof t?(r=t,t=null):"string"!=typeof t&&(r={},t=null),i=function(n){var t,i,p=this,a=$.extend(!0,{},r);for(t in a)a.hasOwnProperty(t)&&(p[t]=a[t]);if("object"==typeof n)for(t in n)n.hasOwnProperty(t)&&(p[t]=n[t]);if(p.el?"string"==typeof p.el?(p.$el=$(p.el),p.el=p.$el.get(0)):p.el instanceof o?(p.$el=p.el,p.el=p.$el.get(0)):p.el instanceof HTMLElement&&(p.$el=$(p.el)):(p.$el=$("<div></div>"),p.el=p.$el.get(0)),"object"==typeof p.model&&void 0!==e.model?e.model.validateGuid(p.model.guid)||(i=e.model.make(p.model),p.model=new i):void 0!==this.model&&(p.model=null),"function"==typeof p.init&&(Array.prototype.shift.apply(arguments),p.init.apply(p,arguments)),"object"==typeof p.events)for(t in p.events)p.events.hasOwnProperty(t)&&"function"==typeof p.events[t]&&function(e,o){e[1]?p.$el.on(e[0],e[1],function(){o.apply(p,arguments)}):p.$el.on(e[0],function(){o.apply(p,arguments)})}(t.split(" "),p.events[t])},t&&(n[t]=i),i};e.controller={make:function(){return r.apply(r,arguments)},construct:function(e){var o;return"function"!=typeof n[e]?null:(o=new(Function.prototype.bind.apply(n[e],arguments)),t.push(o),o)}}}else setTimeout(function(){runFabController(e)},10)}function runField(e){"use strict";var o;window.jQuery&&e.controller&&e.model?(o=e.model.make({uploadKey:"string",uploadActionUrl:"string",csrfToken:"string",elementId:"int",fieldId:"int",fieldName:"string",uploadLocation:"int",uploadFolderId:"int",saveLocation:"int",saveFolderId:"int",minQty:"int",maxQty:"int",preventUploadOverMax:"bool",quality:"int",forceJpg:"bool",retinaMode:"bool",minWidth:"int",minHeight:"int",maxWidth:"int",maxHeight:"int",ratio:"string",ratioWidth:"int",ratioHeight:"int",showTitle:"bool",requireTitle:"int",titleLabel:"string",showCaption:"bool",requireCaption:"bool",captionLabel:"string",showCover:"bool",requireCover:"bool",coverLabel:"string"}),e.controller.make("Field",{sharedModel:null,init:function(){var o={el:this.$el,sharedModel:this.populateSharedModel()};e.controller.construct("FieldDropUploader",o)},populateSharedModel:function(){var e=this,n=e.$el.data("settings"),t={uploadKey:e.$el.data("uploadKey"),uploadActionUrl:e.$el.data("uploadActionUrl"),csrfToken:e.$el.data("csrfToken")};for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r]);return e.sharedModel=new o(t),e.sharedModel}})):setTimeout(function(){runField(e)},10)}function runFieldDropUploader(e){"use strict";e.controller.make("FieldDropUploader",{sharedModel:null,uploadFiles:{},uploadInProgress:!1,init:function(){var o=this,n=o.$el;n.on("drag dragstart dragend dragover dragenter dragleave drop",function(e){e.preventDefault(),e.stopPropagation()}).on("dragover dragenter",function(){n.addClass("AnselField--DragInProgress")}).on("dragleave dragend drop",function(){n.removeClass("AnselField--DragInProgress")}).on("drop",function(t){var r=t.originalEvent.dataTransfer.files;n.addClass("AnselField--IsUploading"),$.each(r,function(n,t){o.uploadFiles[e.uuid.make()]=t})}),o.processUploadFilesWatcher()},processUploadFilesWatcher:function(){var e=this;!e.uploadInProgress&&Object.keys(e.uploadFiles).length?(e.uploadInProgress=!0,e.processUploadFile(Object.keys(e.uploadFiles)[0]),setTimeout(function(){e.processUploadFilesWatcher()},1e3)):setTimeout(function(){e.processUploadFilesWatcher()},1e3)},processUploadFile:function(e){var o=this,n=o.uploadFiles[e],t=new FormData;t.append("CRAFT_CSRF_TOKEN",o.sharedModel.get("csrfToken")),t.append("uploadKey",o.sharedModel.get("uploadKey")),t.append("file",n,n.name),t.append("minWidth",o.sharedModel.get("minWidth")),t.append("minHeight",o.sharedModel.get("minHeight")),$.ajax({url:o.sharedModel.get("uploadActionUrl"),type:"post",data:t,dataType:"json",cache:!1,contentType:!1,processData:!1,complete:function(){console.log("complete"),delete o.uploadFiles[e],o.$el.removeClass("AnselField--IsUploading"),o.uploadInProgress=!1},success:function(e){console.log("success",e)},error:function(e){console.log("fail",e)}})}})}function runMain(e){"use strict";window.jQuery&&e.controller&&e.model?$(".JSAnselField").each(function(){e.controller.construct("Field",{el:this})}):setTimeout(function(){runMain(e)},10)}window.FABNAMESPACE="ANSEL",window[window.FABNAMESPACE]=window.window[window.FABNAMESPACE]||{},window.FABNAMESPACE=window.FABNAMESPACE||"FAB",window[window.FABNAMESPACE]=window.window[window.FABNAMESPACE]||{},runFabController(window[window.FABNAMESPACE]),window.FABNAMESPACE=window.FABNAMESPACE||"FAB",window[window.FABNAMESPACE]=window.window[window.FABNAMESPACE]||{},function(e){"use strict";var o=[],n=function(e){var n;return"object"!=typeof e&&(e={}),(n=function(n){var t,r=this;for(var i in r.guid=(t=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)})()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t(),o.push(r.guid),r.properties={},r.propertyTypes=e,r.changeEvents={},r.propertyTypes)r.propertyTypes.hasOwnProperty(i)&&(r.changeEvents[i]={});for(var p in n)n.hasOwnProperty(p)&&void 0!==r.propertyTypes[p]&&(r.properties[p]=n[p])}).prototype={get:function(e){var o=this;return o.properties[e]?"int"===o.propertyTypes[e]?parseInt(o.properties[e]):"float"===o.propertyTypes[e]?parseFloat(o.properties[e]):"string"===o.propertyTypes[e]?String(o.properties[e]):"bool"===o.propertyTypes[e]?!0===o.properties[e]:"array"===o.propertyTypes[e]?o.properties[e].constructor===Array?o.properties[e]:[]:"object"===o.propertyTypes[e]?o.properties[e].constructor===Object?o.properties[e]:{}:null:"int"===o.propertyTypes[e]||"float"===o.propertyTypes[e]?0:"string"===o.propertyTypes[e]?"":"bool"!==o.propertyTypes[e]&&("array"===o.propertyTypes[e]?[]:"object"===o.propertyTypes[e]?{}:null)},set:function(e,o){var n,t=this,r=!1,i=t.properties[e];if("int"===t.propertyTypes[e]?(t.properties[e]=parseInt(o),r=!0):"float"===t.propertyTypes[e]?(t.properties[e]=parseFloat(o),r=!0):"string"===t.propertyTypes[e]?(t.properties[e]=String(o),r=!0):"bool"===t.propertyTypes[e]?(t.properties[e]=!0===o||"true"===o||"yes"===o||"y"===o,r=!0):"array"===t.propertyTypes[e]?o.constructor===Array&&(t.properties[e]=o,r=!0):"object"===t.propertyTypes[e]&&o.constructor===Object&&(t.properties[e]=o,r=!0),r&&i!==t.properties[e]&&void 0!==t.changeEvents[e])for(var p in n=[t.properties[e],i],t.changeEvents[e])t.changeEvents[e][p].forEach(function(e){e.apply(e,n)})},onChange:function(e,o){var n=this,t=e.split(".");void 0!==n.propertyTypes[t[0]]&&(void 0===t[1]?(void 0===n.changeEvents[t[0]].noNameSpace&&(n.changeEvents[t[0]].noNameSpace=[]),n.changeEvents[t[0]].noNameSpace.push(o)):(void 0===n.changeEvents[t[0]][t[1]]&&(n.changeEvents[t[0]][t[1]]=[]),n.changeEvents[t[0]][t[1]].push(o)))},offChange:function(e){var o=e.split(".");void 0===o[1]?this.changeEvents[o[0]]={}:delete this.changeEvents[o[0]][o[1]]}},n};e.model={make:function(){return n.apply(n,arguments)},validateGuid:function(e){return o.indexOf(e)>-1}}}(window[window.FABNAMESPACE]),window.ANSEL=window.ANSEL||{},runField(window.ANSEL),window.ANSEL=window.ANSEL||{},runFieldDropUploader(window.ANSEL),window.FABNAMESPACE=window.FABNAMESPACE||"FAB",window[window.FABNAMESPACE]=window.window[window.FABNAMESPACE]||{},function(e){"use strict";window[window.FABNAMESPACE].uuid={make:function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}}}(),window.ANSEL=window.ANSEL||{},runMain(window.ANSEL);
//# sourceMappingURL=script.min.js.map