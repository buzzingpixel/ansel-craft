function runFabController(e){"use strict";if(void 0!==window.jQuery){var n=window.jQuery,t={},o=[],i=function(o,i){var r;return"object"==typeof o?(i=o,o=null):"string"!=typeof o&&(i={},o=null),r=function(t){var o,r,s=this,a=$.extend(!0,{},i);for(o in a)a.hasOwnProperty(o)&&(s[o]=a[o]);if("object"==typeof t)for(o in t)t.hasOwnProperty(o)&&(s[o]=t[o]);if(s.el?"string"==typeof s.el?(s.$el=$(s.el),s.el=s.$el.get(0)):s.el instanceof n?(s.$el=s.el,s.el=s.$el.get(0)):s.el instanceof HTMLElement&&(s.$el=$(s.el)):(s.$el=$("<div></div>"),s.el=s.$el.get(0)),"object"==typeof s.model&&void 0!==e.model?e.model.validateGuid(s.model.guid)||(r=e.model.make(s.model),s.model=new r):void 0!==this.model&&(s.model=null),"function"==typeof s.init&&(Array.prototype.shift.apply(arguments),s.init.apply(s,arguments)),"object"==typeof s.events)for(o in s.events)s.events.hasOwnProperty(o)&&"function"==typeof s.events[o]&&function(e,n){e[1]?s.$el.on(e[0],e[1],function(){n.apply(s,arguments)}):s.$el.on(e[0],function(){n.apply(s,arguments)})}(o.split(" "),s.events[o])},o&&(t[o]=r),r};e.controller={make:function(){return i.apply(i,arguments)},construct:function(e){var n;return"function"!=typeof t[e]?null:(n=new(Function.prototype.bind.apply(t[e],arguments)),o.push(n),n)}}}else setTimeout(function(){runFabController(e)},10)}function runField(e){"use strict";var n,t;window.jQuery&&e.controller&&e.model?(n=e.model.make({dragStart:"int",dragEnd:"int",drop:"int",uploadStart:"int",uploadComplete:"int",notificationChange:"int"}),t=e.model.make({uploadKey:"string",uploadActionUrl:"string",csrfToken:"string",elementId:"int",fieldId:"int",fieldName:"string",uploadLocation:"int",uploadFolderId:"int",saveLocation:"int",saveFolderId:"int",minQty:"int",maxQty:"int",preventUploadOverMax:"bool",quality:"int",forceJpg:"bool",retinaMode:"bool",minWidth:"int",minHeight:"int",maxWidth:"int",maxHeight:"int",ratio:"string",ratioWidth:"int",ratioHeight:"int",showTitle:"bool",requireTitle:"int",titleLabel:"string",showCaption:"bool",requireCaption:"bool",captionLabel:"string",showCover:"bool",requireCover:"bool",coverLabel:"string"}),e.controller.make("Field",{sharedModel:null,eventTriggers:null,init:function(){var t,o=this;o.eventTriggers=new n,(t={el:o.$el,sharedModel:o.populateSharedModel(),eventTriggers:o.eventTriggers}).commonObjSend=t,e.controller.construct("Notifications",t),e.controller.construct("FieldDropUploader",t)},populateSharedModel:function(){var e=this,n=e.$el.data("settings"),o={uploadKey:e.$el.data("uploadKey"),uploadActionUrl:e.$el.data("uploadActionUrl"),csrfToken:e.$el.data("csrfToken")};for(var i in n)n.hasOwnProperty(i)&&(o[i]=n[i]);return e.sharedModel=new t(o),e.sharedModel}})):setTimeout(function(){runField(e)},10)}function runFieldDropUploader(e){"use strict";window.jQuery&&e.controller&&e.model?e.controller.make("FieldDropUploader",{sharedModel:null,eventTriggers:null,commonObjSend:null,uploadFiles:{},uploadInProgress:!1,init:function(){var n=this,t=n.$el;t.on("drag dragstart dragend dragover dragenter dragleave drop",function(e){e.preventDefault(),e.stopPropagation()}).on("dragover dragenter",function(){t.addClass("AnselField--DragInProgress"),n.eventTriggers.set("dragStart",n.eventTriggers.get("dragStart")+1)}).on("dragleave dragend drop",function(){t.removeClass("AnselField--DragInProgress"),n.eventTriggers.set("dragEnd",n.eventTriggers.get("dragEnd")+1)}).on("drop",function(o){var i=o.originalEvent.dataTransfer.files;t.addClass("AnselField--IsUploading"),n.eventTriggers.set("drop",n.eventTriggers.get("drop")+1),$.each(i,function(t,o){n.uploadFiles[e.uuid.make()]=o})}),n.processUploadFilesWatcher()},processUploadFilesWatcher:function(){var e=this;e.$el.hasClass("AnselField--IsUploading")&&!Object.keys(e.uploadFiles).length&&(e.$el.removeClass("AnselField--IsUploading"),e.eventTriggers.set("uploadComplete",e.eventTriggers.get("uploadComplete")+1)),!e.uploadInProgress&&Object.keys(e.uploadFiles).length?(e.eventTriggers.set("uploadStart",e.eventTriggers.get("uploadStart")+1),e.uploadInProgress=!0,e.processUploadFile(Object.keys(e.uploadFiles)[0]),setTimeout(function(){e.processUploadFilesWatcher()},500)):setTimeout(function(){e.processUploadFilesWatcher()},500)},processUploadFile:function(n){var t=this,o=t.uploadFiles[n],i=new FormData;i.append("CRAFT_CSRF_TOKEN",t.sharedModel.get("csrfToken")),i.append("uploadKey",t.sharedModel.get("uploadKey")),i.append("file",o,o.name),i.append("minWidth",t.sharedModel.get("minWidth")),i.append("minHeight",t.sharedModel.get("minHeight")),$.ajax({url:t.sharedModel.get("uploadActionUrl"),type:"post",data:i,dataType:"json",cache:!1,contentType:!1,processData:!1,complete:function(){delete t.uploadFiles[n],t.uploadInProgress=!1},success:function(n){n.success?console.log("success"):e.controller.construct("Notification",{el:t.$el,eventTriggers:t.eventTriggers,error:!0,heading:o.name,message:n.message,destroyEvents:["dragStart"]})},error:function(){e.controller.construct("Notification",{el:t.$el,eventTriggers:t.eventTriggers,error:!0,heading:o.name,message:"An unknown error occurred while uploading this file",destroyEvents:["dragStart"]})}})}}):setTimeout(function(){runFieldDropUploader(e)},10)}function runNotification(e){"use strict";window.jQuery&&e.controller&&e.model?e.controller.make("Notification",{eventTriggers:null,error:!1,heading:"",message:"",destroyEvents:[],$notificationList:null,$line:null,init:function(){var e=this,n="";e.$notificationList=e.$el.find(".JSAnselField__Notifications"),e.$line=$('<li class="AnselField__Notification JSAnselField__Notification"></li>'),e.heading&&(n+="<strong>"+e.heading+"</strong>: "),n+=e.message,e.$line.html(n),e.error&&e.$line.addClass("AnselField__Notification--IsError"),e.$line.appendTo(e.$notificationList),e.eventTriggers.set("notificationChange",e.eventTriggers.get("notificationChange")+1),e.destroyEvents.forEach(function(n){e.eventTriggers.onChange(n+"."+e.uuid,function(){e.destroy()})})},destroy:function(){var e=this;e.$line.remove(),e.destroyEvents.forEach(function(n){e.eventTriggers.offChange(n+"."+e.uuid)}),e.eventTriggers.set("notificationChange",e.eventTriggers.get("notificationChange")+1)}}):setTimeout(function(){runNotification(e)},10)}function runNotifications(e){"use strict";window.jQuery&&e.controller&&e.model?e.controller.make("Notifications",{eventTriggers:null,$notifications:null,init:function(){var e=this;e.$notifications=e.$el.find(".JSAnselField__Notifications"),e.eventTriggers.onChange("notificationChange",function(){setTimeout(function(){e.triggerChange()},500)})},triggerChange:function(){this.$notifications.find(".JSAnselField__Notification").length?this.$notifications.addClass("AnselField__Notifications--HasNotifications"):this.$notifications.removeClass("AnselField__Notifications--HasNotifications")}}):setTimeout(function(){runNotifications(e)},10)}function runMain(e){"use strict";window.jQuery&&e.controller&&e.model?$(".JSAnselField").each(function(){e.controller.construct("Field",{el:this})}):setTimeout(function(){runMain(e)},10)}window.FABNAMESPACE="ANSEL",window[window.FABNAMESPACE]=window.window[window.FABNAMESPACE]||{},window.FABNAMESPACE=window.FABNAMESPACE||"FAB",window[window.FABNAMESPACE]=window.window[window.FABNAMESPACE]||{},runFabController(window[window.FABNAMESPACE]),window.FABNAMESPACE=window.FABNAMESPACE||"FAB",window[window.FABNAMESPACE]=window.window[window.FABNAMESPACE]||{},function(e){"use strict";var n=[],t=function(e){var t;return"object"!=typeof e&&(e={}),(t=function(t){var o,i=this;for(var r in i.guid=(o=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)})()+o()+"-"+o()+"-"+o()+"-"+o()+"-"+o()+o()+o(),n.push(i.guid),i.properties={},i.propertyTypes=e,i.changeEvents={},i.propertyTypes)i.propertyTypes.hasOwnProperty(r)&&(i.changeEvents[r]={});for(var s in t)t.hasOwnProperty(s)&&void 0!==i.propertyTypes[s]&&(i.properties[s]=t[s])}).prototype={get:function(e){var n=this;return n.properties[e]?"int"===n.propertyTypes[e]?parseInt(n.properties[e]):"float"===n.propertyTypes[e]?parseFloat(n.properties[e]):"string"===n.propertyTypes[e]?String(n.properties[e]):"bool"===n.propertyTypes[e]?!0===n.properties[e]:"array"===n.propertyTypes[e]?n.properties[e].constructor===Array?n.properties[e]:[]:"object"===n.propertyTypes[e]?n.properties[e].constructor===Object?n.properties[e]:{}:null:"int"===n.propertyTypes[e]||"float"===n.propertyTypes[e]?0:"string"===n.propertyTypes[e]?"":"bool"!==n.propertyTypes[e]&&("array"===n.propertyTypes[e]?[]:"object"===n.propertyTypes[e]?{}:null)},set:function(e,n){var t,o=this,i=!1,r=o.properties[e];if("int"===o.propertyTypes[e]?(o.properties[e]=parseInt(n),i=!0):"float"===o.propertyTypes[e]?(o.properties[e]=parseFloat(n),i=!0):"string"===o.propertyTypes[e]?(o.properties[e]=String(n),i=!0):"bool"===o.propertyTypes[e]?(o.properties[e]=!0===n||"true"===n||"yes"===n||"y"===n,i=!0):"array"===o.propertyTypes[e]?n.constructor===Array&&(o.properties[e]=n,i=!0):"object"===o.propertyTypes[e]&&n.constructor===Object&&(o.properties[e]=n,i=!0),i&&r!==o.properties[e]&&void 0!==o.changeEvents[e])for(var s in t=[o.properties[e],r],o.changeEvents[e])o.changeEvents[e][s].forEach(function(e){e.apply(e,t)})},onChange:function(e,n){var t=this,o=e.split(".");void 0!==t.propertyTypes[o[0]]&&(void 0===o[1]?(void 0===t.changeEvents[o[0]].noNameSpace&&(t.changeEvents[o[0]].noNameSpace=[]),t.changeEvents[o[0]].noNameSpace.push(n)):(void 0===t.changeEvents[o[0]][o[1]]&&(t.changeEvents[o[0]][o[1]]=[]),t.changeEvents[o[0]][o[1]].push(n)))},offChange:function(e){var n=e.split(".");void 0===n[1]?this.changeEvents[n[0]]={}:delete this.changeEvents[n[0]][n[1]]}},t};e.model={make:function(){return t.apply(t,arguments)},validateGuid:function(e){return n.indexOf(e)>-1}}}(window[window.FABNAMESPACE]),window.ANSEL=window.ANSEL||{},runField(window.ANSEL),window.ANSEL=window.ANSEL||{},runFieldDropUploader(window.ANSEL),window.ANSEL=window.ANSEL||{},runNotification(window.ANSEL),window.ANSEL=window.ANSEL||{},runNotifications(window.ANSEL),window.FABNAMESPACE=window.FABNAMESPACE||"FAB",window[window.FABNAMESPACE]=window.window[window.FABNAMESPACE]||{},function(e){"use strict";window[window.FABNAMESPACE].uuid={make:function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}}}(),window.ANSEL=window.ANSEL||{},runMain(window.ANSEL);
//# sourceMappingURL=script.min.js.map