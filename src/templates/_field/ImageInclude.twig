{# @var string uploadKey #}
{# @var string uploadActionUrl #}
{# @var string csrfToken #}
{# @var \buzzingpixel\ansel\models\AnselFieldSettingsModel settings #}

{% set src = src|default(false) %}
{% set id = anselUniqueId() %}
{% set fieldName = settings.fieldName %}

{% import 'ansel/_macros/Macros.twig' as m %}

<div class="AnselField__Image JSAnselField__Image">
    {% if settings.hasModalFields() %}

        {% if settings.showTitle %}
            <input type="hidden" name="{{ m.fieldName(fieldName, id, 'title') }}" class="JSAnselField__Input JSAnselField__Input--Title">
        {% endif %}

        {% if settings.showCaption %}
            <input type="hidden" name="{{ m.fieldName(fieldName, id, 'caption') }}" class="JSAnselField__Input JSAnselField__Input--Caption">
        {% endif %}

        {% if settings.showCover %}
            <input type="hidden" name="{{ m.fieldName(fieldName, id, 'cover') }}" value="0">
            <input type="hidden" name="{{ m.fieldName(fieldName, id, 'cover') }}" class="JSAnselField__Input JSAnselField__Input--Cover">
        {% endif %}

        <input type="hidden" name="{{ m.fieldName(fieldName, id, 'cacheFileLocation') }}" class="JSAnselField__Input JSAnselField__Input--CacheFileLocation">
        <input type="hidden" name="{{ m.fieldName(fieldName, id, 'x') }}" class="JSAnselField__Input JSAnselField__Input--X">
        <input type="hidden" name="{{ m.fieldName(fieldName, id, 'y') }}" class="JSAnselField__Input JSAnselField__Input--Y">
        <input type="hidden" name="{{ m.fieldName(fieldName, id, 'width') }}" class="JSAnselField__Input JSAnselField__Input--Width">
        <input type="hidden" name="{{ m.fieldName(fieldName, id, 'height') }}" class="JSAnselField__Input JSAnselField__Input--Height">

        <input type="hidden" name="{{ m.fieldName(fieldName, id, 'cacheFile') }}" class="JSAnselField__Input JSAnselField__Input--CacheFile">
        <input type="hidden" name="{{ m.fieldName(fieldName, id, 'fileName') }}" class="JSAnselField__Input JSAnselField__Input--FileName">

        <input
            type="hidden"
            name="{{ m.fieldName(fieldName, id, 'preManipulation[fileLocation]') }}"
            class="JSAnselField__Input JSAnselField__Input--PreFileLocation"
        >
        <input
            type="hidden"
            name="{{ m.fieldName(fieldName, id, 'preManipulation[fileLocationType]') }}"
            class="JSAnselField__Input JSAnselField__Input--PreFileLocationType"
        >
        <input
            type="hidden"
            name="{{ m.fieldName(fieldName, id, 'preManipulation[h]') }}"
            class="JSAnselField__Input JSAnselField__Input--PreH"
        >
        <input
            type="hidden"
            name="{{ m.fieldName(fieldName, id, 'preManipulation[w]') }}"
            class="JSAnselField__Input JSAnselField__Input--PreW"
        >
        <input
            type="hidden"
            name="{{ m.fieldName(fieldName, id, 'preManipulation[x]') }}"
            class="JSAnselField__Input JSAnselField__Input--PreX"
        >
        <input
            type="hidden"
            name="{{ m.fieldName(fieldName, id, 'preManipulation[y]') }}"
            class="JSAnselField__Input JSAnselField__Input--PreY"
        >
        <input
            type="hidden"
            name="{{ m.fieldName(fieldName, id, 'preManipulation[highQualityImgCacheLocation]') }}"
            class="JSAnselField__Input JSAnselField__Input--PreHighQualityImgCacheLocation"
        >
        <input
            type="hidden"
            name="{{ m.fieldName(fieldName, id, 'preManipulation[standardImgCacheLocation]') }}"
            class="JSAnselField__Input JSAnselField__Input--PreStandardImgCacheLocation"
        >
        <input
            type="hidden"
            name="{{ m.fieldName(fieldName, id, 'preManipulation[thumbImgCacheLocation]') }}"
            class="JSAnselField__Input JSAnselField__Input--PreThumbImgCacheLocation"
        >
        <input
            type="hidden"
            name="{{ m.fieldName(fieldName, id, 'preManipulation[maxHeight]') }}"
            class="JSAnselField__Input JSAnselField__Input--PreMaxHeight"
        >
        <input
            type="hidden"
            name="{{ m.fieldName(fieldName, id, 'preManipulation[maxWidth]') }}"
            class="JSAnselField__Input JSAnselField__Input--PreMaxWidth"
        >

    {% endif %}

    <div class="AnselField__ImageIcons">
        <div class="AnselField__ImageIconsInner">
            {% if settings.hasModalFields() %}
                <div class="AnselField__ImageIcon AnselField__ImageIconEdit JSAnselField__ImageIconEdit">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z" class=""></path></svg>
                </div>
            {% endif %}
            <div class="AnselField__ImageIcon AnselField__ImageIconCrop JSAnselField__ImageIconCrop">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M488 352h-40V109.3l57-57c9.4-9.4 9.4-24.6 0-33.9L493.7 7c-9.4-9.4-24.6-9.4-33.9 0l-57 57H160V24c0-13.3-10.7-24-24-24H88C74.7 0 64 10.7 64 24v40H24C10.7 64 0 74.7 0 88v48c0 13.3 10.7 24 24 24h40v264c0 13.3 10.7 24 24 24h264v40c0 13.3 10.7 24 24 24h48c13.3 0 24-10.7 24-24v-40h40c13.3 0 24-10.7 24-24v-48c0-13.3-10.7-24-24-24zM306.7 160L160 306.7V160h146.7zM205.3 352L352 205.3V352H205.3z" class=""></path></svg>
            </div>
            <div class="AnselField__ImageIcon AnselField__ImageIconRemove JSAnselField__ImageIconRemove">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 64 384 384"><path fill="currentColor" d="M323.1 441l53.9-53.9c9.4-9.4 9.4-24.5 0-33.9L279.8 256l97.2-97.2c9.4-9.4 9.4-24.5 0-33.9L323.1 71c-9.4-9.4-24.5-9.4-33.9 0L192 168.2 94.8 71c-9.4-9.4-24.5-9.4-33.9 0L7 124.9c-9.4 9.4-9.4 24.5 0 33.9l97.2 97.2L7 353.2c-9.4 9.4-9.4 24.5 0 33.9L60.9 441c9.4 9.4 24.5 9.4 33.9 0l97.2-97.2 97.2 97.2c9.3 9.3 24.5 9.3 33.9 0z" class=""></path></svg>
            </div>
        </div>
    </div>
    <div class="AnselField__ImageWrapper">
        <div class="AnselField__ImageWrapperInner JSAnselField__ImageWrapperInner">
            <img{% if src %} src="{{ src }}"{% endif %} alt="" class="AnselField__ImageTag JSAnselField__ImageTag">
        </div>
    </div>
</div>
